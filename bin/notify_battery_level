#!/bin/bash

capacity_file="/sys/class/power_supply/BAT0/capacity"

time=180

almost_low=0
low=0

notif() {
    notify-send -u "$1" "$2" &
}

while true; do
    cap=$(cat $capacity_file)
    if [ $cap -le 15 ] && [ "$low" == "0" ]; then
        low=1
        notif "critical" "LOW_BATTERY"
    elif [ $cap -le 30 ] && [ "$almost_low" == "0" ]; then
        almost_low=1
        notif "normal" "BATTERY < 30 %"
    fi

    sleep $time;
done
