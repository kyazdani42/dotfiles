#!/bin/bash
echo "-- * get data for the specified agency, year and month * --"

echo -n "agency: "
read agency

echo -n "year: "
read year

echo -n "month: "
read month

# echo -n "production | staging: "
# read bucket_type

# [ $bucket_type != "staging" -a $bucket_type != "production" ] && echo "bucket type must be staging or production" && exit 1

year_month="$year/$month"
# creating folders
mkdir -p $agency/referential
mkdir -p $agency/{stoptimes,courses,validations}/$year_month

# copying data
# default_url="gs://cit-io-datalake-$agency/cit-io-$bucket_type"
default_url="gs://cit-io-clean-staging/$agency"
gsutil_cmd="gsutil -m cp -r"

$gsutil_cmd $default_url/referential ./$agency
$gsutil_cmd $default_url/stoptimes/$year_month ./$agency/stoptimes/$year
$gsutil_cmd $default_url/courses/$year_month ./$agency/courses/$year
$gsutil_cmd $default_url/validations/$year_month ./$agency/validations/$year
